% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotGeneBoxplot.R
\name{plotGeneBoxplot}
\alias{plotGeneBoxplot}
\title{Perform Differential Expression Analysis Between Response Groups}
\usage{
plotGeneBoxplot(
  pset,
  gene,
  groupLabels,
  mDataType = "rna",
  plotType = c("boxplot", "violin"),
  showPoints = TRUE,
  pointColor = "#0072B2"
)
}
\arguments{
\item{pset}{A PharmacoSet object from the PharmacoGx package.}

\item{groupLabels}{A named factor vector with levels "sensitive" and
"resistant", typically output from \code{defineResponseGroups()}.
Names must correspond to sample identifiers in the PSet.}

\item{mDataType}{A character string specifying the molecular data type.
Default is "rna" for gene expression.}

\item{method}{A character string specifying the statistical method.
Options are:
\itemize{
  \item "t.test" - Welch's t-test for each gene (default)
  \item "limma" - Linear modeling with empirical Bayes (requires limma package)
}}
}
\value{
A data frame with the following columns:
\itemize{
  \item gene - Character vector of gene names
  \item logFC - Numeric vector of log fold changes (sensitive - resistant)
  \item pval - Numeric vector of p-values
  \item adj_pval - Numeric vector of FDR-adjusted p-values
}
}
\description{
Identifies genes that are differentially expressed between drug-sensitive
and drug-resistant samples. Supports t-test or limma-based analysis methods.
Returns statistical measures including log fold change and adjusted p-values
for each gene.
}
\examples{
library(PharmacoGx)

# Load data
# pset <- downloadPSet("NCI60_2021")

# (for demo purposes we will use the mini dataset)
data("nci60_mini")

drug_name <- drugNames(nci60_mini)[1]
# Define response groups using median split
groups <- defineResponseGroups(
  pset = nci60_mini,
  drug = drug_name,
  sensitivity.measure = "aac_recomputed",
  method = "median"
)

# Run differential expression using t-test
diff_expr <- runDiffExpr(
  pset = nci60_mini,
  groupLabels = groups,
  mDataType = "rna",
  method = "t.test"
)

# Pick the top significant gene for plotting
top_gene <- diff_expr$gene[which.min(diff_expr$adj_pval)]

# Plot boxplot of expression for top gene
p <- plotGeneBoxplot(
  pset = nci60_mini,
  gene = top_gene,
  groupLabels = groups,
  mDataType = "rna",
  plotType = "boxplot"
)
print(p)

# Optional: violin plot
p_violin <- plotGeneBoxplot(
  pset = nci60_mini,
  gene = top_gene,
  groupLabels = groups,
  mDataType = "rna",
  plotType = "violin"
)
print(p_violin)

}
\references{
Morgan, M., Obenchain, V., Hester, J., PagÃ¨s, H. (2024).
SummarizedExperiment: A container (S4 class) for matrix-like assays.
R package version 1.36.0.
\href{https://doi.org/10.18129/B9.bioc.SummarizedExperiment}{Link}.

Smirnov, P., Safikhani, Z., El-Hachem, N., Wang, D., She, A., Olsen, C.,
Freeman, M., Selby, H., Gendoo, D. M., Grossman, P., Beck, A. H.,
Aerts, H. J., Lupien, M., Goldenberg, A., & Haibe-Kains, B. (2016).
PharmacoGx: an R package for analysis of large pharmacogenomic datasets.
\emph{Bioinformatics}, 32(8), 1244-1246.
\href{https://doi.org/10.1093/bioinformatics/btv723}{Link}.

R Core Team (2024). R: A Language and Environment for Statistical Computing.
R Foundation for Statistical Computing, Vienna, Austria.
\href{https://www.R-project.org/}{Link}.

Ritchie, M. E., Phipson, B., Wu, D., Hu, Y., Law, C. W., Shi, W., &
Smyth, G. K. (2015). limma powers differential expression analyses for
RNA-sequencing and microarray studies. \emph{Nucleic Acids Research},
43(7), e47. \href{https://doi.org/10.1093/nar/gkv007}{Link}.
}
