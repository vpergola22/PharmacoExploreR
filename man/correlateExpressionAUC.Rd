% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correlateExpressionAUC.R
\name{correlateExpressionAUC}
\alias{correlateExpressionAUC}
\title{Correlate Gene Expression with Drug Response}
\usage{
correlateExpressionAUC(
  pset,
  drug,
  mDataType = "rna",
  sensitivity.measure = "auc_recomputed",
  method = "pearson"
)
}
\arguments{
\item{pset}{A PharmacoSet object from the PharmacoGx package containing
molecular profiling and drug sensitivity data.}

\item{drug}{A character string specifying the drug name to analyze. Must
match a drug name in the sensitivity data. Use \code{drugNames(pset)}
to see available options.}

\item{mDataType}{A character string specifying the molecular data type.
Default is "rna" for gene expression. Other options depend on the
PharmacoSet (e.g., "mutation", "cnv").}

\item{sensitivity.measure}{A character string specifying the sensitivity
metric to use. Default is "auc_recomputed". Common options include
"aac_recomputed", "ic50_published", "auc_published".}

\item{method}{A character string specifying the correlation method.
Options are "pearson" (default), "spearman", or "kendall".}
}
\value{
A data frame with the following columns:
\itemize{
  \item gene - Character vector of gene names
  \item cor - Numeric vector of correlation coefficients
  \item pval - Numeric vector of p-values from correlation tests
  \item adj_pval - Numeric vector of FDR-adjusted p-values
}
}
\description{
Computes correlations between gene expression levels and drug sensitivity
metrics (e.g., AUC, AAC, IC50) for a specified drug across samples in a
PharmacoSet object. For each gene, the function calculates the correlation
coefficient, p-value, and FDR-adjusted p-value to identify genes whose
expression is associated with drug response.
}
\examples{
# Load the bundled mini PharmacoSet dataset
data("nci60_mini")

# View available drugs
head(PharmacoGx::drugNames(nci60_mini))

# Correlate gene expression with drug response
results <- correlateExpressionAUC(
  pset = nci60_mini,
  drug = "Erlotinib",
  mDataType = "rna",
  sensitivity.measure = "aac_recomputed",
  method = "pearson"
)

# View top correlated genes
head(results[order(abs(results$cor), decreasing = TRUE), ])

# Filter for significant genes (safe even if adj_pval has NAs)
sig_genes <- subset(results, !is.na(adj_pval) & adj_pval < 0.05)

}
\references{
Morgan, M., Obenchain, V., Hester, J., PagÃ¨s, H. (2024).
SummarizedExperiment: A container (S4 class) for matrix-like assays.
R package version 1.36.0.
\href{https://doi.org/10.18129/B9.bioc.SummarizedExperiment}{Link}.

Smirnov, P., Safikhani, Z., El-Hachem, N., Wang, D., She, A., Olsen, C.,
Freeman, M., Selby, H., Gendoo, D. M., Grossman, P., Beck, A. H.,
Aerts, H. J., Lupien, M., Goldenberg, A., & Haibe-Kains, B. (2016).
PharmacoGx: an R package for analysis of large pharmacogenomic datasets.
\emph{Bioinformatics}, 32(8), 1244-1246.
\href{https://doi.org/10.1093/bioinformatics/btv723}{Link}.
}
